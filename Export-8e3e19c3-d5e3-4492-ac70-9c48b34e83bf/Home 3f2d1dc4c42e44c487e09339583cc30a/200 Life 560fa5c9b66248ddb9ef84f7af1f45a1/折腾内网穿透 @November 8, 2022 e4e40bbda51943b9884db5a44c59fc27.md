# 折腾内网穿透 @November 8, 2022

很久没有折腾路由器了。昨天看到司波图的一个关于内网穿透的视频，觉得挺不错的。就跟着研究了一下内网穿透，发现其实并不是难事。其实在此之前，本来也看到一个利用IPv6来获取公网地址实现内网访问的视频，跟着做了一下但是没有成功。倒是看到不少大佬们纷纷建议不要使用IPv6来实现，所以就放弃。而这次利用其它方式来折腾，就相对顺利多了。

### 内网穿透方式

视频介绍了Frp和Zerotier两种方式，我首先跟着实现的是Frp模式，很快就实现了从外部访问家里NAS的功能。但是后面看到其实大多网友是推荐后者，因为相比frp需要将所有端口在服务器里面设置，直接暴露出来，后者采用了类VPN联网的方式安全性更高。所以晚上我又开始折腾Zerotier。很不幸，路由器上的Zerotier并没有顺利链接。于是，我考虑更新一下路由器的固件。

### 路由器固件更新

嗯，这样就开始了更新路由器小折腾之旅：昨晚下载路由器固件速度太慢，今早才开始更新路由器固件。更新完发现连不上路由器：电脑无法获取IP地址。只好接上显示器看看什么情况，但是似乎也发现不了什么问题，通过ifcongfig我可以看出IP地址其实是已经正确配置了，但是为什么电脑不能通过DHCP获得IP呢，也不能ping通这个路由器。仔细观察我发现其实有一个网口是有信号的，连上另一个无线ap发现这次居然能获取IP并且可以访问路由器，再通过网页看了系统状态明白了：路由器的固件其实已经被正确更新并启动，只是这个固件默认只开启了一个lan口和一个wan口，并且wan口的物理网口和我以前那个固件不一样，所以有部分网络其实并未连接。于是我根据新wan口的物理网口位置调整了插线，并把剩余两个物理网口加入lan口，网络就正常了。这样我又可以开始用软路由快乐上网了。

## Zerotire

配置好路由，我首先试了一下zerotire的连接，果然一下子就连接上去了。看来就是原来的路由器固件有点问题。配置好zerotier后，通过和frp对比了一下发现确实是后者感觉比较好。也比较顺利的实现通过路由器来访问内网其他设备，手机，电脑，路由器都可以在一个虚拟网络内实现连接。再添加上Summer提供的Moon服务器，整体看上去比较不错。刚出去时候在外面试了一下，也比较顺利的就连接到家里的路由器设置界面，所以zerotier应该是配置成功了。撒花🎉