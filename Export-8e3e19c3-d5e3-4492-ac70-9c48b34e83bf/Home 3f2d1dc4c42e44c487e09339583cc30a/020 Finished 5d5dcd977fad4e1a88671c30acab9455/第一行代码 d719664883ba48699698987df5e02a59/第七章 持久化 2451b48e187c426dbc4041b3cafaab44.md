# ç¬¬ä¸ƒç«  æŒä¹…åŒ–

# 7.2 æ–‡ä»¶å­˜å‚¨

### **7.2.1** å°†æ•°æ®å­˜å‚¨åˆ°æ–‡ä»¶ä¸­

Contextç±»ä¸­æä¾›äº†ä¸€ä¸ªopenFileOutput()æ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå°†æ•°æ®å­˜å‚¨åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚

```kotlin
fun save(inputText: String) {
    try {
        val output = openFileOutput("data", Context.MODE_PRIVATE)
        val writer = BufferedWriter(OutputStreamWriter(output))
        writer.use { //useæ–¹æ³•ï¼Œè‡ªåŠ¨å…³é—­lambdaè¡¨è¾¾å¼ä¸­çš„streamï¼Œæ— éœ€æ‰‹åŠ¨å†™finally
            it.write(inputText)
        }
    } catch (e: IOException) {
        e.printStackTrace()
} }
```

<aside>
ğŸ˜µâ€ğŸ’« Kotlinæ˜¯æ²¡æœ‰å¼‚å¸¸æ£€æŸ¥æœºåˆ¶(checked exception)çš„ã€‚è¿™æ„å‘³ç€ä½¿ç”¨Kotlinç¼–å†™çš„æ‰€ æœ‰ä»£ç éƒ½ä¸ä¼šå¼ºåˆ¶è¦æ±‚ä½ è¿›è¡Œå¼‚å¸¸æ•è·æˆ–å¼‚å¸¸æŠ›å‡ºã€‚ä¸Šè¿°ä»£ç ä¸­çš„try catchä»£ç å—æ˜¯å‚ç…§ Javaçš„ç¼–ç¨‹è§„èŒƒæ·»åŠ çš„ï¼Œå³ä½¿ä½ ä¸å†™try catchä»£ç å—ï¼Œåœ¨Kotlinä¸­ä¾ç„¶å¯ä»¥ç¼–è¯‘é€šè¿‡ã€‚

</aside>

# 7.3 SharedPreferenceså­˜å‚¨

ä¸åŒäºæ–‡ä»¶çš„å­˜å‚¨æ–¹å¼ï¼ŒSharedPreferencesæ˜¯ä½¿ç”¨é”®å€¼å¯¹çš„æ–¹å¼æ¥å­˜å‚¨æ•°æ®çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ å½“ä¿å­˜ä¸€æ¡æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦ç»™è¿™æ¡æ•°æ®æä¾›ä¸€ä¸ªå¯¹åº”çš„é”®ï¼Œè¿™æ ·åœ¨è¯»å–æ•°æ®çš„æ—¶å€™å°±å¯ä»¥é€š è¿‡è¿™ä¸ªé”®æŠŠç›¸åº”çš„å€¼å–å‡ºæ¥ã€‚è€Œä¸”SharedPreferencesè¿˜æ”¯æŒå¤šç§ä¸åŒçš„æ•°æ®ç±»å‹å­˜å‚¨ï¼Œå¦‚æœ å­˜å‚¨çš„æ•°æ®ç±»å‹æ˜¯æ•´å‹ï¼Œé‚£ä¹ˆè¯»å–å‡ºæ¥çš„æ•°æ®ä¹Ÿæ˜¯æ•´å‹çš„;å¦‚æœå­˜å‚¨çš„æ•°æ®æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ ä¹ˆè¯»å–å‡ºæ¥çš„æ•°æ®ä»ç„¶æ˜¯å­—ç¬¦ä¸²

## **7.3.1** å°†æ•°æ®å­˜å‚¨åˆ°**SharedPreferences**ä¸­

è¦æƒ³ä½¿ç”¨SharedPreferenceså­˜å‚¨æ•°æ®ï¼Œé¦–å…ˆéœ€è¦è·å–SharedPreferenceså¯¹è±¡ã€‚

- **Context**ç±»ä¸­çš„**getSharedPreferences()**æ–¹æ³•
- **Activity**ç±»ä¸­çš„**getPreferences()**æ–¹æ³•

# **7.4 SQLite**æ•°æ®åº“å­˜å‚¨

## **7.4.1** åˆ›å»ºæ•°æ®åº“

Androidä¸ºäº†è®©æˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ æ–¹ä¾¿åœ°ç®¡ç†æ•°æ®åº“ï¼Œä¸“é—¨æä¾›äº†ä¸€ä¸ªSQLiteOpenHelperå¸®åŠ©
ç±»ï¼Œå€ŸåŠ©è¿™ä¸ªç±»å¯ä»¥éå¸¸ç®€å•åœ°å¯¹æ•°æ®åº“è¿›è¡Œåˆ›å»ºå’Œå‡çº§ã€‚

SQLiteOpenHelperæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨å®ƒï¼Œå°±éœ€è¦åˆ› å»ºä¸€ä¸ªè‡ªå·±çš„å¸®åŠ©ç±»å»ç»§æ‰¿å®ƒã€‚

SQLiteOpenHelperä¸­æœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•:`onCreate()`å’Œ `onUpgrade()`ã€‚

# **7.5 SQLite**æ•°æ®åº“çš„æœ€ä½³å®è·µ

## **7.5.1** ä½¿ç”¨äº‹åŠ¡

SQLiteæ•°æ®åº“æ˜¯æ”¯æŒäº‹åŠ¡çš„ï¼Œäº‹åŠ¡çš„ç‰¹æ€§å¯ä»¥ä¿è¯è®©ä¸€ç³»åˆ—çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œ è¦ä¹ˆä¸€ä¸ªéƒ½ä¸ä¼šå®Œæˆã€‚

```kotlin
class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        val dbHelper = MyDatabaseHelper(this, "BookStore.db", 2)
        ...
replaceData.setOnClickListener {
	val db = dbHelper.writableDatabase 
	db.beginTransaction() // å¼€å¯äº‹åŠ¡ 
			try {
                db.delete("Book", null, null)
```